数据倾斜的作用就是通过不断的优化sql语句是读取信息的时间得到压缩，减少时间的浪费，还可以通过增加map的数量在进一步优化sql来减少时间的浪费。

如下所示

with t1 as (    select  userid,           

​									order_no,           

​									concat**(region,'-',**rand**()) as region,           **

​									product_no,           

​									color_no,           

​									sale_amount,           

​									ts    

​						from date_east ),    

​						t2 as (        select region,               

​													  count**(1) as cnt        **

​											from t1

​											group by region    ),    

​						t3 as (        select region,               

​														substr(region,1,2) as re,      

​														cnt        

​														from t2    ) 

​						select re,       **count**(1) as cnt from t3 

​						group by re;